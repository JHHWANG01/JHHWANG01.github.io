---
title: "안드로이드스튜디오 db 연동"
excerpt: "마리아 디비"
categories: 
- blogging
tags: 
- jekyll
last_modified_at: 2019-01-28T13:00:00+09:00
toc: true
toc_sticky: true
toc: true
---

## 통신 코드

<uses-permisson android:name="android.permission.INTERNET"/>

## HttpPost
//인터넷 주소를 알아와서 Post 방식으로 값을보냄
HttpPost post = new HttpPost("http://175.210.155.212:8080/myserver/~.jsp");

## execute
//클라이언트에서 행할 일을 선언함
DefaultHttpCliet client = new DefaultHttpClient();

## Post의 값을 수행하면서 바로 값을 가져오기를 대기
HttpResponse response = client.execute(post);

## 버퍼클래스

그럼 값을 받을 땐 어떻게 해야할까?

그 땐 버퍼클래스를 이용하게 된다.

BufferedReader bufreader = new BufferedReader(new InputStreamReader(response.getEntity().getContent(), "utf-8"));

// 소스를 잘 보면 reponse 인스턴스를 이용해서 getEntity()와 getContent()를 가져오는데, 이 동작이 바로 값을 가져오는

// 행위이다. 이렇게만 해주면 값을 알아서 받아온다. 옆에 소심하게 "utf-8"이라고 정의된 친구는 

// 이 값을 어떤 인코딩 방식으로 받아올 것인지를 의미한다. JSP가 utf-8 으로 값을 보내면 거기에 맞게, euc-kr로 보내면

// 또 거기에 맞게 설정해주면 된다.

## 외부 접근 허용 설정 방법

로컬 폴더에 JSP 파일을 넣어주면 되는데, JSP파일은

HTML 설정은 일체 하지말고 단순히 <% %>를 이용해서 정의해주고 보낼 부분은 out.println이나



<%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="EUC-KR" import="java.sql.*" import = "java.util.*"%> <% request.setCharacterEncoding("utf-8"); // 데이터베이스 드라이버와 연결 Class.forName("com.mysql.jdbc.Driver"); // 데이터베이스와 연결 - 로컬호스트:포트번호/테이블명 String url="jdbc:mysql://localhost:3306/Diary"; Connection connection = DriverManager.getConnection(url,"root","1234"); // 쿼리를 실행하기 위한 선언 Statement stmt = connection.createStatement(); // 호출되면서 넘어온 값 받기 String bookName = request.getParameter("book_name"); String bookGenre = request.getParameter("book_genre"); String bookWriter = request.getParameter("book_writer"); String bookPublisher = request.getParameter("book_publisher"); // 쿼리 실행 String query = "insert into diarydb.books" // bookstable 이란 테이블에 + " (book_name, book_writer, book_genre, book_publisher)" // 이 속성의 값들을 + " values ('"+bookName+"', '"+bookWriter+"', '"+bookGenre+"', '"+bookPublisher+"') "; stmt.executeUpdate(query); stmt.close(); connection.close(); %>


